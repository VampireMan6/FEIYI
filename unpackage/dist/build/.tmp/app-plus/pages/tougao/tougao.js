(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/tougao/tougao"],{"571f":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=s(i("a34a")),o=(i("2f62"),n(i("bc1b")));function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};a.get||a.set?Object.defineProperty(e,i,a):e[i]=t[i]}return e.default=t,e}function s(t){return t&&t.__esModule?t:{default:t}}function u(t,e,i,a,o,n,s){try{var u=t[n](s),c=u.value}catch(r){return void i(r)}u.done?e(c):Promise.resolve(c).then(a,o)}function c(t){return function(){var e=this,i=arguments;return new Promise(function(a,o){var n=t.apply(e,i);function s(t){u(n,a,o,s,c,"next",t)}function c(t){u(n,a,o,s,c,"throw",t)}s(void 0)})}}var r={data:function(){return{text:"",image:"",imageurl:"",video:"",openid:"",userinfo:"",token:"",showlogin:!1}},onShow:function(){this.checkstat(),this.token||(this.showlogin=!0)},methods:{checkstat:function(){var t=o.default.checklogin();this.openid=t.openid,this.userinfo=t.userinfo,this.token=t.token},close:function(t){this[t]=""},chooseImage:function(){var e=c(a.default.mark(function e(){var i;return a.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:i=this,i.image&&t.showToast({title:"只可上传一张图片,将自动替换为新选择的",icon:"none"}),t.chooseImage({count:1,sizeType:"compressed ",success:function(e){i.image=e.tempFilePaths[0],t.uploadFile({url:o.default.apiurl+"syj/index/upimg",filePath:e.tempFilePaths[0],name:"image",header:{auth:o.default.httpauth},success:function(e){e.data=JSON.parse(e.data),200==e.statusCode&&e.data.code<1?i.imageurl=e.data.imageurl:(t.showToast({title:e.data.msg,icon:"none"}),i.image=i.imageurl="")}})}});case 3:case"end":return e.stop()}},e,this)}));function i(){return e.apply(this,arguments)}return i}(),send:function(e){if(!this.token)return this.showlogin=!0,!1;if(!this.text&&!this.image&&!this.video)return t.showToast({title:"文字、图片、视频三者至少填写一个",icon:"none"}),!1;t.showLoading({title:"发布中请稍等..."});var i=this;i.video?t.uploadFile({url:o.default.apiurl+"syj/index/tougao",filePath:i.video,name:"video",formData:{text:i.text,image:i.imageurl},header:{auth:o.default.httpauth},success:function(e){"string"===typeof e.data&&(e.data=JSON.parse(e.data)),200==e.statusCode&&e.data.code<1?(t.showToast({title:e.data.msg}),setTimeout(function(){t.hideLoading()},1e3),i.text=i.image=i.video=""):(t.showToast({title:e.data.msg,icon:"none"}),setTimeout(function(){t.hideLoading()},1e3))},fail:function(){t.hideLoading()}}):t.request({url:o.default.apiurl+"syj/index/tougao",method:"POST",data:{text:i.text,image:i.imageurl,token:i.token,shebei:o.default.shebei},success:function(e){200==e.statusCode&&e.data.code<1?(i.text=i.image=i.video="",t.showToast({title:e.data.msg}),setTimeout(function(){t.hideLoading()},1e3)):(t.showToast({title:e.data.msg,icon:"none"}),setTimeout(function(){t.hideLoading()},1e3))},fail:function(){t.hideLoading()},header:{auth:o.default.httpauth}})},chooseVideo:function(){var e=this;t.chooseVideo({sourceType:["album","camera"],success:function(t){e.video=t.tempFilePath}})},login:function(t){o.default.logincomm(t,this)}}};e.default=r}).call(this,i("649d")["default"])},"5e66":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"index"},[i("navigator",{attrs:{url:"../../platforms/app-plus/login/login"}},[t.showlogin||!t.token?i("button",{attrs:{id:"showlogin",type:"warn"}},[t._v("请先登录")]):t._e()],1),t.token?i("block",[i("view",{staticClass:"textcontent"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"feedback-textare",attrs:{placeholder:"输入文字内容...",eventid:"21cbad1c-0"},domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}})]),i("view",{staticClass:"uni-uploader"},[i("view",{staticClass:"uni-uploader-body"},[i("view",{directives:[{name:"show",rawName:"v-show",value:t.image,expression:"image"}],staticClass:"uni-uploader__files"},[i("view",{staticClass:"uni-uploader__file"},[i("view",{staticClass:"iconfont icon-close",attrs:{eventid:"21cbad1c-1"},on:{click:function(e){t.close("image")}}}),i("image",{staticClass:"uni-uploader__img",attrs:{src:t.image,"data-src":t.image}})])]),i("view",{staticClass:"uni-uploader__input-box"},[i("view",{staticClass:"uni-uploader__input",attrs:{eventid:"21cbad1c-2"},on:{tap:t.chooseImage}}),i("view",{staticClass:"image-plus-text"},[t._v("只可添加一张图片")])])])]),i("view",{staticClass:"uni-uploader"},[i("view",{staticClass:"uni-uploader-body"},[i("view",{directives:[{name:"show",rawName:"v-show",value:t.video,expression:"video"}],staticClass:"uni-uploader__files"},[i("view",{staticClass:"uni-uploader__file"},[i("view",{staticClass:"iconfont icon-close",attrs:{eventid:"21cbad1c-3"},on:{click:function(e){t.close("video")}}}),i("video",{staticClass:"uni-uploader__video",attrs:{src:t.video}})])]),i("view",{staticClass:"uni-uploader__input-box"},[i("view",{staticClass:"uni-uploader__input",attrs:{eventid:"21cbad1c-4"},on:{tap:t.chooseVideo}}),i("view",{staticClass:"image-plus-text"},[t._v("只可添加一部视频")])])])]),i("button",{staticClass:"feedback-submit",attrs:{type:"warn",eventid:"21cbad1c-5"},on:{click:t.send}},[t._v("立即投稿")])],1):t._e()],1)},o=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return o})},6590:function(t,e,i){},"6d08":function(t,e,i){"use strict";var a=i("6590"),o=i.n(a);o.a},9259:function(t,e,i){"use strict";i.r(e);var a=i("5e66"),o=i("bb9d");for(var n in o)"default"!==n&&function(t){i.d(e,t,function(){return o[t]})}(n);i("6d08");var s=i("2877"),u=Object(s["a"])(o["default"],a["a"],a["b"],!1,null,null,null);e["default"]=u.exports},b035:function(t,e,i){"use strict";i("9e4e");var a=n(i("b0ce")),o=n(i("9259"));function n(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(o.default))},bb9d:function(t,e,i){"use strict";i.r(e);var a=i("571f"),o=i.n(a);for(var n in a)"default"!==n&&function(t){i.d(e,t,function(){return a[t]})}(n);e["default"]=o.a}},[["b035","common/runtime","common/vendor"]]]);