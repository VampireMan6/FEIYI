(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/detail/detail"],{"71a5":function(t,e,i){"use strict";i("9e4e");var a=s(i("b0ce")),n=s(i("f503"));function s(t){return t&&t.__esModule?t:{default:t}}Page((0,a.default)(n.default))},"75e1":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"index"},[i("view",{staticClass:"card"},[t.data.text?i("view",{staticClass:"car-title-view"},[i("rich-text",{attrs:{nodes:t.data.text,mpcomid:"269b2f48-0"}})],1):t._e(),t.data.img?i("image",{staticClass:"card-img",attrs:{src:t.data.img,mode:"widthFix",eventid:"269b2f48-0"},on:{click:function(e){t.previmg(t.data.img)}}}):t._e(),t.data.video?i("video",{attrs:{src:t.data.video,controls:""}}):t._e(),i("view",{staticClass:"iconbottom"},[i("view",{staticClass:"iconfont icon-appreciate_light",class:t.data.type&&"like"==t.data.type?"active":"",attrs:{eventid:"269b2f48-1"},on:{click:function(e){t.setlike("like",0,t.data.id)}}},[i("text",[t._v(t._s(t.data.like))])]),i("view",{staticClass:"icon-oppose_light iconfont",class:t.data.type&&"hate"==t.data.type?"active":"",attrs:{eventid:"269b2f48-2"},on:{click:function(e){t.setlike("hate",0,t.data.id)}}},[i("text",[t._v(t._s(t.data.hate))])])])]),t.loading?i("text",{staticClass:"loadMore"},[t._v("加载中...")]):t._e(),i("view",{staticClass:"section"},[i("form",{attrs:{eventid:"269b2f48-4"},on:{submit:t.send}},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],attrs:{placeholder:"期待你的神评论",eventid:"269b2f48-3"},domProps:{value:t.text},on:{focus:t.checklogin,input:function(e){e.target.composing||(t.text=e.target.value)}}}),i("button",{attrs:{"form-type":"submit",size:"mini"}},[t._v("发表评论")])],1)],1),t.replylist.length?i("view",{staticClass:"uni-list"},t._l(t.replylist,function(e,a){return i("view",{key:a,staticClass:"uni-list-cell"},[i("view",{staticClass:"uni-media-list"},[i("view",{staticClass:"uni-media-list-body"},[i("view",{staticClass:"uni-media-list-text-bottom"},[i("image",{staticClass:"uni-media-list-logo",attrs:{src:e.avatar?e.avatar:"../../static/logo.png"}}),i("text",[t._v(t._s(e.nickName))]),i("text",[t._v("评论于"+t._s(e.pubtime))])]),i("view",{staticClass:"uni-media-list-text-top"},[t._v(t._s(e.text))])])])])})):t._e(),t.showlogin?i("button",{attrs:{"open-type":"getUserInfo",id:"showlogin",type:"warn",eventid:"269b2f48-5"},on:{getuserinfo:t.login}},[t._v("使用微信登录")]):t._e(),t.showlogin?i("view",{attrs:{id:"mask",eventid:"269b2f48-6"},on:{click:function(e){t.showlogin=!1}}}):t._e()],1)},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},"7c9c":function(t,e,i){},aba6:function(t,e,i){"use strict";i.r(e);var a=i("ea9f"),n=i.n(a);for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);e["default"]=n.a},b8d6:function(t,e,i){"use strict";var a=i("7c9c"),n=i.n(a);n.a},ea9f:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;i("2f62");var a=n(i("bc1b"));function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var a=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,i):{};a.get||a.set?Object.defineProperty(e,i,a):e[i]=t[i]}return e.default=t,e}var s={data:function(){return{data:{},detailDec:"",text:"",id:"",showlogin:!1,replylist:[],fetchPageNum:1,openid:"",token:"",userinfo:"",loading:!0}},onShow:function(){this.checkstat(),this.fetchPageNum=1,this.getData(this.id)},onLoad:function(e){this.id=e.id;var i=this;t.getStorage({key:"detail-"+this.id,success:function(e){i.data=(0,a.parGetData)(e.data);var n=i.data.text;n&&(n=n.replace(/<*?>/gi,"").substr(0,12),i.detailDec=n,t.setNavigationBarTitle({title:n}))},complete:function(){this.loading=!1}})},onShareAppMessage:function(){return{title:this.detailDec?this.detailDec:"最新最好笑的趣事趣图，来看下吧",path:"/pages/detail/detail?id="+this.id}},methods:{checkstat:function(){var t=a.default.checklogin();this.openid=t.openid,this.userinfo=t.userinfo,this.token=t.token},checklogin:function(){return!!this.token||(t.showModal({title:"请登录",content:"请登录后继续操作",confirmText:"去登录",success:function(e){if(e.confirm)return t.navigateTo({url:"/platforms/app-plus/login/login"}),!1}}),!1)},send:function(e){if(!this.checklogin())return!1;if(!this.text)return t.showToast({title:"请输入评论内容",icon:"none"}),!1;var i=this;i.replylist.unshift({text:this.text,avatar:this.userinfo.avatarUrl,nickName:this.userinfo.nickName,pubtime:"刚刚"}),t.request({url:a.default.apiurl+"syj/index/setpinglun",method:"POST",data:{text:i.text,id:i.id,token:i.token,shebei:a.default.shebei},success:function(e){200==e.statusCode&&e.data.code<1?(i.text="",t.showToast({title:"审核后显示"}),setTimeout(function(){t.hideLoading()},1e3)):(t.showToast({title:e.data.msg,icon:"none"}),setTimeout(function(){t.hideLoading()},1e3))},fail:function(){t.hideLoading()},complete:function(){this.loading=!1},header:{auth:a.default.httpauth}})},setlike:function(t,e,i){a.default.setlike(this,this.data,t,i)},previmg:function(e){t.previewImage({urls:[e]})},onReachBottom:function(){this.getData(this.id)},getData:function(e){var i=this;i.loading=!0,t.request({url:a.default.apiurl+"syj/index/getpinglun",method:"POST",dataType:"json",data:{page:i.fetchPageNum,pagesize:20,order:"addtime",id:i.id,token:i.token,shebei:a.default.shebei},success:function(e){if(i.loading=!1,200!==e.statusCode)t.showToast({title:"请求数据失败请重试"+e.statusCode,duration:2e3,icon:"none"});else{if(i.fetchPageNum<2);else if(e.data.replylist.length<1)return t.showToast({title:"没有更多评论了",icon:"none"}),!1;i.replylist=i.replylist.concat(e.data.replylist),i.fetchPageNum+=1}},fail:function(e){t.showToast({title:"请求数据失败请重试",duration:2e3,icon:"none"})},complete:function(){i.loading=!1},header:{auth:a.default.httpauth}})},login:function(t){a.default.logincomm(t,this)}}};e.default=s}).call(this,i("649d")["default"])},f503:function(t,e,i){"use strict";i.r(e);var a=i("75e1"),n=i("aba6");for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);i("b8d6");var o=i("2877"),c=Object(o["a"])(n["default"],a["a"],a["b"],!1,null,null,null);e["default"]=c.exports}},[["71a5","common/runtime","common/vendor"]]]);